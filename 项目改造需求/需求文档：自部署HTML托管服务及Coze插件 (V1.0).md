# **需求文档：自部署HTML托管服务及Coze插件 (V1.0)**

| 文档状态 | 草稿 |
| :---- | :---- |
| **创建日期** | 2025-08-19 |
| **创建人** | 大鹏 & Gemini |
| **最后更新** | 2025-08-19 |

### **1\. 项目背景与目标**

#### **1.1 项目背景**

当前，用户（大鹏）在 Coze (扣子) 平台开发 AI Bot 时，需要一个能将大模型生成的 HTML 代码快速部署并生成公开访问链接的工具。市面上已有类似插件，但存在数据隐私和控制权问题，所有 HTML 代码都将部署在第三方服务器上。

为了实现数据私有化、增强服务可控性，用户计划基于现有的开源项目 html\_deploy 进行二次开发，打造一个部署在自己服务器上的私有化 HTML 托管服务，并通过 Coze 插件与之集成。

#### **1.2 项目目标**

本项目的核心目标是，将现有的 html\_deploy 项目改造为一个支持 API 调用的后端服务，并开发一个配套的 Coze 插件，最终实现一个安全、私有、可控的自动化 HTML 代码部署流程。

* **短期目标 (V1.0):**  
  1. 为后端服务增加安全的、基于 Token 的 API 认证机制。  
  2. 开发一个简单的后台管理页面，用于查看已部署的 HTML 页面。  
  3. 创建一个 Coze 插件，能调用后端 API，实现从代码到链接的转换。  
* **长期愿景:**  
  * 打造一个稳定、可靠的个人 PaaS (平台即服务) 工具，为未来更多 AI Bot 的创意落地提供基础。

### **2\. 用户故事**

1. **作为 Coze Bot 的开发者：**  
   * 我希望能够通过一个安全的 API 接口，将一段 HTML 代码发送到我的服务器，以便我的服务器能自动为这段代码生成一个独一无二的、任何人都可以访问的 URL 链接。  
2. **作为服务的所有者：**  
   * 我希望使用一个预设的、保密的 API Token 来保护我的 API 接口，以便确保只有我自己的 Coze 插件能够调用它，防止未经授权的访问和滥用。  
3. **作为服务的所有者：**  
   * 我希望有一个受密码保护的后台管理页面，以便我能方便地查看所有已经通过 API 或网页部署的 HTML 页面列表，了解每个页面的基本信息（如ID、创建时间），并能快速访问它们。

### **3\. 功能需求详述 (Functional Requirements)**

#### **3.1 后端服务改造 (html\_deploy 项目)**

##### **3.1.1 API 接口增强**

* **需求点：** 改造现有的页面创建接口 (/api/pages/create)，使其支持双重认证机制。  
* **验收标准：**  
  1. 保留原有的基于 Session/Cookie 的网页登录认证，确保网站原有功能不受影响。  
  2. 新增基于 HTTP Header 中 Authorization: Bearer \<TOKEN\> 的 API Token 认证方式。  
  3. API Token 应在服务器的环境变量中配置，而不是硬编码在代码里。  
  4. 当 Coze 插件使用正确的 Token 调用该接口时，请求应能通过认证。  
  5. 当使用错误或不提供 Token 调用时，请求应被拒绝。  
  6. 接口成功处理后，应返回一个包含 success 状态和 url 链接的 JSON 对象，以适配 Coze 插件的输出规范。

##### **3.1.2 后台管理系统 (Admin Dashboard)**

* **需求点：** 创建一个新的后台管理页面，用于集中展示所有已部署的 HTML 页面。  
* **验收标准：**  
  1. 后台管理页面的访问路径为 /admin/dashboard。  
  2. 访问该页面必须通过现有的网页登录认证 (isAuthenticated 中间件)。  
  3. 页面以表格形式展示所有已部署的 HTML 页面列表。  
  4. 表格应至少包含以下列：页面ID、创建时间、是否加密。  
  5. 每一行的“页面ID”应是一个可点击的链接，点击后跳转到对应的 /view/\<ID\> 页面。

#### **3.2 Coze 插件开发**

* **需求点：** 在 Coze 平台创建一个插件，用于调用改造后的后端服务。  
* **验收标准：**  
  1. 插件应通过 **“基于 API 创建插件”** 的方式创建。  
  2. 插件内包含一个工具，用于执行 HTML 部署操作。  
  3. 工具的 API Endpoint 指向部署在用户自己服务器上的 /api/pages/create 接口。  
  4. 工具的输入参数应包括：  
     * html\_content (String, 必填): 待部署的 HTML 代码。  
     * token (String, 必填): 用于 API 认证的密钥。  
  5. 工具的输出参数应包括：  
     * url (String): 部署成功后返回的公开访问链接。  
     * success (Boolean): 表示操作是否成功的状态。  
  6. 在 Coze Bot 中调用该插件，并提供 HTML 代码和正确的 Token，能够成功返回可访问的 URL。

### **4\. 非功能性需求 (Non-Functional Requirements)**

* **安全性 (Security):**  
  * API Token 和后台登录密码必须设置为强密码。  
  * 部署时，服务器防火墙应只开放必要的端口。  
  * **\[V2.0 考虑\]** 为服务配置 HTTPS，保证数据传输安全。  
* **易用性 (Usability):**  
  * 后台管理页面应简洁明了，易于操作。  
  * Coze 插件的参数描述应清晰准确，便于大模型理解和调用。  
* **可靠性 (Reliability):**  
  * 后端服务应能 7x24 小时稳定运行。  
  * 数据库文件 (.db) 需要有定期备份机制，防止数据丢失。

### **5\. 项目范围**

#### **5.1 V1.0 包含范围 (In Scope)**

* 上述所有功能需求。  
* 项目的 Docker 化部署。

#### **5.2 V1.0 暂不包含范围 (Out of Scope)**

* 后台管理页面的搜索、删除、编辑功能。  
* Coze 插件支持自定义 URL 或密码保护。  
* 为服务配置 HTTPS。  
* 更复杂的错误处理和日志系统。